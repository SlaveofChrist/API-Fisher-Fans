openapi: 3.1.1
info:
  title: FisherFans API
  version: "AOS v3.1"
servers:
  - url: https://api.fisherfans.example.com/

tags:
  - name: Utilisateurs
  - name: Bateaux
  - name: Sorties
  - name: Réservations
  - name: Carnets
  - name: Pages

paths:
  /v1/utilisateurs:
    get:
      tags: [Utilisateurs]
      summary: Lister les utilisateurs
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/pageSize'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items: { $ref: '#/components/schemas/Utilisateur' }
    post:
      tags: [Utilisateurs]
      summary: Créer un utilisateur
      requestBody: { $ref: '#/components/requestBodies/UtilisateurInput' }
      responses:
        '201':
          description: Créé
          content:
            application/json:
              schema: { $ref: '#/components/schemas/Utilisateur' }

  /v1/utilisateurs/{utilisateurId}:
    get:
      tags: [Utilisateurs]
      summary: Détail d'un utilisateur
      parameters: [ { $ref: '#/components/parameters/utilisateurId' } ]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/Utilisateur' }
    patch:
      tags: [Utilisateurs]
      summary: Mettre à jour un utilisateur
      parameters: [ { $ref: '#/components/parameters/utilisateurId' } ]
      requestBody: { $ref: '#/components/requestBodies/UtilisateurInput' }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/Utilisateur' }
    delete:
      tags: [Utilisateurs]
      summary: Supprimer un utilisateur
      parameters: [ { $ref: '#/components/parameters/utilisateurId' } ]
      responses: { '204': { description: Supprimé } }

  /v1/bateaux:
    get:
      tags: [Bateaux]
      summary: Lister les bateaux
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/pageSize'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items: { $ref: '#/components/schemas/Bateau' }
    post:
      tags: [Bateaux]
      summary: Créer un bateau
      requestBody: { $ref: '#/components/requestBodies/BateauInput' }
      responses:
        '201':
          description: Créé
          content:
            application/json:
              schema: { $ref: '#/components/schemas/Bateau' }

  /v1/bateaux/{bateauId}:
    get:
      tags: [Bateaux]
      summary: Détail d'un bateau
      parameters: [ { $ref: '#/components/parameters/bateauId' } ]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/Bateau' }
    patch:
      tags: [Bateaux]
      summary: Mettre à jour un bateau
      parameters: [ { $ref: '#/components/parameters/bateauId' } ]
      requestBody: { $ref: '#/components/requestBodies/BateauInput' }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/Bateau' }
    delete:
      tags: [Bateaux]
      summary: Supprimer un bateau
      parameters: [ { $ref: '#/components/parameters/bateauId' } ]
      responses: { '204': { description: Supprimé } }

  /v1/sorties:
    get:
      tags: [Sorties]
      summary: Lister les sorties
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/pageSize'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items: { $ref: '#/components/schemas/SortiePeche' }
    post:
      tags: [Sorties]
      summary: Créer une sortie
      requestBody: { $ref: '#/components/requestBodies/SortiePecheInput' }
      responses:
        '201':
          description: Créé
          content:
            application/json:
              schema: { $ref: '#/components/schemas/SortiePeche' }

  /v1/sorties/{sortieId}:
    get:
      tags: [Sorties]
      summary: Détail d'une sortie
      parameters: [ { $ref: '#/components/parameters/sortieId' } ]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/SortiePeche' }
    patch:
      tags: [Sorties]
      summary: Mettre à jour une sortie
      parameters: [ { $ref: '#/components/parameters/sortieId' } ]
      requestBody: { $ref: '#/components/requestBodies/SortiePecheInput' }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/SortiePeche' }
    delete:
      tags: [Sorties]
      summary: Supprimer une sortie
      parameters: [ { $ref: '#/components/parameters/sortieId' } ]
      responses: { '204': { description: Supprimé } }

  /v1/sorties/{sortieId}/reservations:
    get:
      tags: [Réservations]
      summary: Lister les réservations d'une sortie
      parameters: [ { $ref: '#/components/parameters/sortieId' } ]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items: { $ref: '#/components/schemas/Reservation' }
    post:
      tags: [Réservations]
      summary: Réserver
      parameters: [ { $ref: '#/components/parameters/sortieId' } ]
      requestBody: { $ref: '#/components/requestBodies/ReservationInput' }
      responses:
        '201':
          description: Créé
          content:
            application/json:
              schema: { $ref: '#/components/schemas/Reservation' }

  /v1/reservations/{reservationId}:
    get:
      tags: [Réservations]
      summary: Détail d'une réservation
      parameters: [ { $ref: '#/components/parameters/reservationId' } ]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/Reservation' }
    delete:
      tags: [Réservations]
      summary: Annuler une réservation
      parameters: [ { $ref: '#/components/parameters/reservationId' } ]
      responses: { '204': { description: Annulée } }

  /v1/carnets:
    post:
      tags: [Carnets]
      summary: Créer un carnet
      requestBody: { $ref: '#/components/requestBodies/CarnetPecheInput' }
      responses:
        '201':
          description: Créé
          content:
            application/json:
              schema: { $ref: '#/components/schemas/CarnetPeche' }

  /v1/carnets/{carnetId}:
    get:
      tags: [Carnets]
      summary: Détail d'un carnet
      parameters: [ { $ref: '#/components/parameters/carnetId' } ]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/CarnetPeche' }
    delete:
      tags: [Carnets]
      summary: Supprimer un carnet
      parameters: [ { $ref: '#/components/parameters/carnetId' } ]
      responses: { '204': { description: Supprimé } }

  /v1/carnets/{carnetId}/pages:
    get:
      tags: [Pages]
      summary: Lister les pages d'un carnet
      parameters: [ { $ref: '#/components/parameters/carnetId' } ]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items: { $ref: '#/components/schemas/PageCarnetPeche' }
    post:
      tags: [Pages]
      summary: Ajouter une page
      parameters: [ { $ref: '#/components/parameters/carnetId' } ]
      requestBody: { $ref: '#/components/requestBodies/PageCarnetPecheInput' }
      responses:
        '201':
          description: Créé
          content:
            application/json:
              schema: { $ref: '#/components/schemas/PageCarnetPeche' }

  /v1/carnets/{carnetId}/pages/{pageId}:
    get:
      tags: [Pages]
      summary: Détail d'une page
      parameters:
        - $ref: '#/components/parameters/carnetId'
        - $ref: '#/components/parameters/pageId'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/PageCarnetPeche' }
    delete:
      tags: [Pages]
      summary: Supprimer une page
      parameters:
        - $ref: '#/components/parameters/carnetId'
        - $ref: '#/components/parameters/pageId'
      responses: { '204': { description: Supprimé } }

components:
  parameters:
    utilisateurId:
      name: utilisateurId
      in: path
      required: true
      schema: { type: integer }
    bateauId:
      name: bateauId
      in: path
      required: true
      schema: { type: integer }
    sortieId:
      name: sortieId
      in: path
      required: true
      schema: { type: integer }
    reservationId:
      name: reservationId
      in: path
      required: true
      schema: { type: integer }
    carnetId:
      name: carnetId
      in: path
      required: true
      schema: { type: integer }
    pageId:
      name: pageId
      in: path
      required: true
      schema: { type: integer }
    page:
      name: page
      in: query
      schema: { type: integer, minimum: 1, default: 1 }
    pageSize:
      name: pageSize
      in: query
      schema: { type: integer, minimum: 1, maximum: 200, default: 20 }

  requestBodies:
    UtilisateurInput:
      required: true
      content:
        application/json:
          schema: { $ref: '#/components/schemas/UtilisateurInput' }
    BateauInput:
      required: true
      content:
        application/json:
          schema: { $ref: '#/components/schemas/BateauInput' }
    SortiePecheInput:
      required: true
      content:
        application/json:
          schema: { $ref: '#/components/schemas/SortiePecheInput' }
    ReservationInput:
      required: true
      content:
        application/json:
          schema: { $ref: '#/components/schemas/ReservationInput' }
    CarnetPecheInput:
      required: true
      content:
        application/json:
          schema: { $ref: '#/components/schemas/CarnetPecheInput' }
    PageCarnetPecheInput:
      required: true
      content:
        application/json:
          schema: { $ref: '#/components/schemas/PageCarnetPecheInput' }

  schemas:
    Utilisateur:
      type: object
      properties:
        idUtilisateur: { type: integer }
        nom: { type: string }
        prenom: { type: string }
        email: { type: string, format: email }
      required: [idUtilisateur, nom, prenom, email]

    UtilisateurInput:
      type: object
      properties:
        nom: { type: string }
        prenom: { type: string }
        email: { type: string, format: email }
      required: [nom, prenom, email]

    Bateau:
      type: object
      properties:
        idBateau: { type: integer }
        nom: { type: string }
        capaciteMax: { type: integer }
        proprietaireId: { type: integer }
      required: [idBateau, nom, capaciteMax, proprietaireId]

    BateauInput:
      type: object
      properties:
        nom: { type: string }
        capaciteMax: { type: integer }
        proprietaireId: { type: integer }
      required: [nom, capaciteMax, proprietaireId]

    SortiePeche:
      type: object
      properties:
        idSortie: { type: integer }
        titre: { type: string }
        nombrePassagers: { type: integer }
        organisateurId: { type: integer }
        bateauId: { type: integer }
        prix: { type: number }
      required: [idSortie, titre, nombrePassagers, organisateurId, bateauId, prix]

    SortiePecheInput:
      type: object
      properties:
        titre: { type: string }
        nombrePassagers: { type: integer }
        organisateurId: { type: integer }
        bateauId: { type: integer }
        prix: { type: number }
      required: [titre, nombrePassagers, organisateurId, bateauId, prix]

    Reservation:
      type: object
      properties:
        idReservation: { type: integer }
        date: { type: string, format: date }
        nombrePlaces: { type: integer }
        prixTotal: { type: number }
        createurReservationId: { type: integer }
        sortieId: { type: integer }
      required: [idReservation, date, nombrePlaces, prixTotal, createurReservationId, sortieId]

    ReservationInput:
      type: object
      properties:
        date: { type: string, format: date }
        nombrePlaces: { type: integer }
        createurReservationId: { type: integer }
      required: [date, nombrePlaces, createurReservationId]

    CarnetPeche:
      type: object
      properties:
        idCarnetPeche: { type: integer }
        proprietaireId: { type: integer }
      required: [idCarnetPeche, proprietaireId]

    CarnetPecheInput:
      type: object
      properties:
        proprietaireId: { type: integer }
      required: [proprietaireId]

    PageCarnetPeche:
      type: object
      properties:
        idPageCarnetPeche: { type: integer }
        carnetId: { type: integer }
        datePeche: { type: string, format: date }
      required: [idPageCarnetPeche, carnetId, datePeche]

    PageCarnetPecheInput:
      type: object
      properties:
        carnetId: { type: integer }
        datePeche: { type: string, format: date }
      required: [carnetId, datePeche]
